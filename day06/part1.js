// Example usage
const map = [
"....................................#.............#...............#..............................................................#",
"........................#....#............................................##.......#...................................#..........",
".........#...............................................#..#.......#...#...........#......................#......................",
"...........#...........#...................#...........#.........................................#............................#...",
"................................................................#.....#...............................................#........#..",
"......................#..........#.#.......................................#...#........................................#.........",
"....#.......................#............#............#....#....................................................................#.",
"#.........#....................#.............#......................#............#....#..#................#........#.#.....#......",
".................##...................#.................................#.........................................................",
"...........#...................................................................##..........#..........#.....#...............#.....",
"..................................#.........#....................................#....#..#...........................#............",
"............#.....#............................................................#......................#........#........#.........",
".........#.........#......#...#.........#..............................................................................#..........",
".........#..............................#..............#...........#.......................................#....#.............#...",
"...................................................................................................#..........#...................",
"....#.........#......................#..........#.........................................................................#......#",
"..............#.#........#..#......#..............................................................................................",
"#....#....#........................#...#...........................................#.....................#..#.......#...#.........",
"...............................#.........#........#.....................................#.........................................",
"................................#.....#..........#..........................................................#.....................",
"...#.......#...........#.....................................................#.....#...#.#..#...............#.#...................",
"...#...............#..#..................#.........................#................................................#.............",
".#................#................................................#.#...........................#.............#................#.",
"....................#...............#..............#.........................................................#................#...",
"...............................................................................................#..........#.......................",
"............#......................................#....................................................#.........................",
".......#.....#..................#....................................................................#..................#.....#...",
"...........#..........................................#.#.........................................................................",
"..........#..............................#.................................................................#..............#.......",
"...............#.........#...........#..........................................................................#.................",
"...............##................................................................##...#....................#....................#.",
"............##..........................................................................#....#............#.......................",
"........#.............#.#..#......#..#...........................#........#...........................#....................#......",
"...............................................................#........................#.#...................................#...",
"..#.....#.#............................#..........................................................................................",
"............................................#.#...........#....#............#.....#.......#..............#...................#....",
"..........................#............................#.#........................#......................#....#...................",
"..................#.......................#....#....................................#....................................#........",
"................#............................................#..............#...............................................#.#...",
".............#.......................#...#............#...........................................................#..............#",
"#.#...#.............................................................#.#...........................................................",
"....#.............#..#.............................................#.............................#................................",
"..........................................#........#....#.........................#......................................#........",
"............................#..........#...........................#.......................................#......................",
"...#.......#..............#...........................#................................................#.......................#..",
".#...............................#......................#...................#.........#...........................................",
".#.....#......#........................#........#...............#..............................................#..........#.......",
"...........................................................................................................................#......",
"........................#......................................#............#.....................................................",
"........#.....#........#...............#.............#....#..........................................#.#.........................#",
"...........#........#.......#.........................................#.............................................#.............",
".........#......#..........................................................................................#.....#................",
"........................................#...#...............#..................................#...........#......................",
".......................................#.......#.#....#...#.................#.....#......^#.......................................",
".#............#......#..........................................#.#......................................#............#.......#...",
".................#.......#.........#........#..........................................................................#.....#....",
"...#..............................#.................#.........................#.........#.........................................",
"...#.................................................#..............#......................................................#......",
"....................#.#...............................#................#.....##...................................................",
".........#...#....#.............................#.........#....#.....##............................#........#.....................",
"........#....#..............................#..................................................................#....#......#......",
"..........................#..#...........#..............#...............#....#..........#.........................................",
"...........#..........#...........................................#.......................##......................................",
".............................................................................................#...................#...........#....",
"...............................#................#.....#...#..#....#...............................................................",
"#...#........#...#...................#.......#......................................................................#.............",
"#..................#..................................................................................#....................#..#..#",
".#............#..#...........#................#.......#........#.........#...........#..............#.............................",
".......................................#....#........#..............................................#..........#..................",
"...#....#........................................#....#...........................................................#....#.......#..",
"..............#....#.......................................#.............#..#.................................#...................",
"........................................#.#.......................#.#.......................................#.....................",
"......................#...#....................................................................................#.................#",
"........#...#...........#.....................#......#..........................................#.....................#.....#.....",
"...#......................#..........#............................................................................................",
"..............................................................................#..........#.....#..........#...#...................",
"........#............#.............#........##..................................................#...#.............................",
"..#....................................................................#.................#..........#.......#.........##..........",
"...................#.....................................................#......................#...#..#............#.............",
"......................................##.........#........................................................#...........#...........",
"..#..................................................#........................#...................#...............#...............",
"....#...................................#........#........................................................#.....................#.",
"....#.#......#..........................................#........................#................................................",
"#........................#.....................................................................................#...#..............",
".#.............................#.......#...............#............#............#.....#.....#........#......#....................",
"....#......................................................#.......................................................#.......#...#..",
"............#.........................#.......##..............................#...................#.....#......#..................",
"........................................................................................#........................#.........#......",
".#.......................#.........................#................#..##.........#..#.....................................#......",
"#...............#................#...#........#.........#......................#...................................#......#.#.....",
"................#............................##...................................#............#.....................#............",
"..#...#.................................................................#.........#.........................##................#...",
"...........................................#.................#............................#..#..............#......#.#............",
".................#...........#..................#................#........#...............................#.................#..#.#",
".......#.......................#................................#.#...............................................................",
".......#.........#.........#...........................................................................#.........#...........#....",
".....#.#................................................#.......#..........#......................................................",
"......................#.........................................#................#...............................#................",
"..........................#....#.......#....#.................#.#.................................................##...#..#.......",
"......................................................#.......#..#.....#............#...#..................................#......",
".........#.#...............................#..........#...............................#...............#......................#....",
"..#...........................#.............................#............#...............#......#........................#........",
".........#................................................................#....#..#.....##................#.........#.......#.....",
"...#....................................#...........#.............#...........................................#...................",
"#.........................#..........#.....................#......#.............#...........#...................................##",
"....................#......#...#.#.............................................#.............................#..............#.....",
".....................#...#.....#......#.............................#........#......#.............#...............................",
"..................#.............................................................................#..............#..................",
".......#...........................#........................................................................#...............#.....",
"............................................#......................................#..............................................",
".....#..........#..................#.............#................................................#..................#...#......##",
"..............................................................#........................................#...............#..........",
"...................................#.#........................................................#.#...........#.....................",
"...#....................#........#.....................#..................................#..............#..#.....................",
".................#....................#...#.....#..........#......#...........................#.#............................#.#..",
"....................................................#.............#..#.....#......................................................",
".......#..............................#...............................................#.........................#.......#.........",
"........#...............#.................................................................................................#......#",
"#.#.#..............................................................#..............#................#...........#..........#.......",
"..#.....................................#...........#................................................#................#......#....",
"#.........................................................#...#................................#......#.#..........#..............",
".#...#................#......#................##...#.........#.............#........#.........#........#.....#....................",
"................#..........................#.#................................................#.............#.....................",
"..............#................................................................#.............................#.............#......",
"..................................#...................................#...........................................................",
"........#.................#....#.........................................................................................#........",
"...........#...................#........#.......#................................................#..#......#..#...................",
".........#.....#......................................................................#.........................#.....#...........",
"..........................................................#.............................................#.....#...................",
"...............#.##.................#....#.................#...#.......................#...................#........#............."
];

function predictGuardPath(map) {
    const directions = ['^', '>', 'v', '<'];
    const moves = { '^': [-1, 0], '>': [0, 1], 'v': [1, 0], '<': [0, -1] };
    const turnRight = { '^': '>', '>': 'v', 'v': '<', '<': '^' };

    let rows = map.length;
    let cols = map[0].length;
    let visited = new Set();
    let guardPos, guardDir;

    // Find the initial position and direction of the guard
    for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
            if (directions.includes(map[r][c])) {
                guardPos = [r, c];
                guardDir = map[r][c];
                break;
            }
        }
    }

    while (true) {
        visited.add(`${guardPos[0]},${guardPos[1]}`);
        let [dr, dc] = moves[guardDir];
        let [newRow, newCol] = [guardPos[0] + dr, guardPos[1] + dc];

        // Check if the guard is still within bounds
        if (newRow < 0 || newRow >= rows || newCol < 0 || newCol >= cols) {
            break;
        }

        // Check if there is an obstacle
        if (map[newRow][newCol] === '#') {
            guardDir = turnRight[guardDir];
        } else {
            guardPos = [newRow, newCol];
        }
    }

    return visited.size;
}

console.log(predictGuardPath(map));
